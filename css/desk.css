/* ============================================
   MORNING DESK SCREEN — 70s Nordic Noir
   ============================================ */

#screen-desk {
  background:
    /* Wood grain texture */
    repeating-linear-gradient(
      2deg,
      transparent 0px,
      transparent 3px,
      rgba(0,0,0,0.06) 3px,
      rgba(0,0,0,0.06) 4px
    ),
    /* Warm lamp glow from upper right */
    radial-gradient(ellipse at 85% 10%, rgba(245,228,160,0.12) 0%, transparent 50%),
    /* Subtle vignette */
    radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.3) 100%),
    /* Base wood color */
    linear-gradient(180deg, #3a2a18 0%, #2a1f12 30%, #241a0e 100%);
  padding: 0;
  position: relative;
}

/* Desk edge shadow at bottom */
#screen-desk::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(180deg, transparent, rgba(0,0,0,0.4));
  pointer-events: none;
  z-index: 3;
}

/* — Top bar with window — */
.desk-top-bar {
  height: 48px;
  position: relative;
  display: flex;
  align-items: flex-end;
  padding: 0 var(--sp-3);
  /* Darker wall behind the window */
  background:
    linear-gradient(180deg, #1a1208 0%, #221a0e 70%, transparent 100%);
}

.desk-window {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 200px;
  height: 42px;
  border: 2px solid #4a3a28;
  border-top: none;
  overflow: hidden;
  box-shadow: 0 0 20px rgba(135,206,235,0.08);
}

.desk-window-sky {
  width: 100%;
  height: 100%;
  transition: background-color 1s ease;
  position: relative;
}

.desk-window-sky.morning   { background: linear-gradient(180deg, #6ab4d9 0%, #a8d8ea 60%, #d4e8c4 100%); }
.desk-window-sky.afternoon { background: linear-gradient(180deg, #e8b860 0%, #f5d89a 50%, #f0c878 100%); }
.desk-window-sky.evening   { background: linear-gradient(180deg, #1a1020 0%, #2c1810 60%, #0a0a14 100%); }

/* Småstad town silhouette — layered buildings */
.desk-window-sky::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 18px;
  background:
    /* Church spire */
    linear-gradient(to right,
      transparent 28%, #1a1208 28%, #1a1208 29%, transparent 29%
    ),
    /* Church cross */
    linear-gradient(to right,
      transparent 27.5%, #1a1208 27.5%, #1a1208 29.5%, transparent 29.5%
    ) 0 3px / 100% 2px no-repeat,
    /* Buildings skyline */
    polygon(0% 100%, /* start bottom-left */
    0% 70%, 8% 70%, 8% 55%, 15% 55%, 15% 65%, 22% 65%, 22% 45%,
    25% 45%, 25% 30%, 27% 30%, 27% 18%, 30% 18%, 30% 35%, 33% 35%,
    33% 50%, 38% 50%, 38% 60%, 45% 60%, 45% 50%, 52% 50%, 52% 62%,
    58% 62%, 58% 55%, 62% 55%, 62% 48%, 68% 48%, 68% 58%, 72% 58%,
    72% 65%, 78% 65%, 78% 52%, 82% 52%, 82% 60%, 88% 60%, 88% 70%,
    94% 70%, 94% 65%, 100% 65%, 100% 100%);
  /* Fallback: simple dark blocks */
  clip-path: polygon(
    0% 100%,
    0% 72%, 6% 72%, 6% 58%, 12% 58%, 12% 68%, 18% 68%,
    18% 52%, 22% 52%, 22% 42%, 25% 42%, 25% 22%, 28% 22%,
    28% 12%, 29.5% 12%, 29.5% 22%, 32% 22%, 32% 42%,
    36% 42%, 36% 55%, 42% 55%, 42% 62%, 48% 62%, 48% 52%,
    54% 52%, 54% 65%, 60% 65%, 60% 55%, 65% 55%, 65% 48%,
    70% 48%, 70% 60%, 76% 60%, 76% 68%, 82% 68%, 82% 55%,
    86% 55%, 86% 62%, 92% 62%, 92% 72%, 100% 72%,
    100% 100%
  );
  background: #1a1208;
  opacity: 0.85;
}

/* Window lit squares (tiny yellow lights in buildings) */
.desk-window-sky::after {
  content: '';
  position: absolute;
  bottom: 3px;
  left: 0;
  right: 0;
  height: 14px;
  background:
    radial-gradient(circle 1px, rgba(255,220,100,0.7) 0%, transparent 100%) 12px 6px,
    radial-gradient(circle 1px, rgba(255,220,100,0.5) 0%, transparent 100%) 40px 4px,
    radial-gradient(circle 1px, rgba(255,220,100,0.6) 0%, transparent 100%) 66px 8px,
    radial-gradient(circle 1px, rgba(255,220,100,0.4) 0%, transparent 100%) 90px 5px,
    radial-gradient(circle 1px, rgba(255,220,100,0.5) 0%, transparent 100%) 120px 7px,
    radial-gradient(circle 1px, rgba(255,220,100,0.6) 0%, transparent 100%) 150px 4px,
    radial-gradient(circle 1px, rgba(255,220,100,0.4) 0%, transparent 100%) 170px 9px;
  background-repeat: no-repeat;
  pointer-events: none;
  z-index: 1;
}

/* — Boss note (pinned top) — */
.boss-note {
  position: absolute;
  top: 4px;
  right: 56px;
  background: #ffe680;
  padding: var(--sp-1) var(--sp-2);
  font-family: var(--font-body);
  font-size: 8px;
  color: var(--ink);
  max-width: 120px;
  line-height: 1.3;
  transform: rotate(2deg);
  box-shadow: 1px 1px 2px var(--shadow);
  border-bottom: 1px solid #d4c060;
  z-index: 5;
}

.boss-note-close {
  position: absolute;
  top: -6px;
  right: -6px;
  width: 14px;
  height: 14px;
  background: #d4c060;
  border: 1px solid #b8a040;
  border-radius: 50%;
  font-family: var(--font-body);
  font-size: 9px;
  font-weight: bold;
  color: var(--ink);
  cursor: pointer;
  padding: 0;
  line-height: 14px;
  text-align: center;
  opacity: 0.7;
  transition: opacity 0.15s, transform 0.15s;
  z-index: 6;
  box-shadow: 0 1px 2px rgba(0,0,0,0.3);
}

.boss-note-close:hover {
  opacity: 1;
  transform: scale(1.15);
  background: #c4a830;
}

.boss-note-name {
  font-weight: bold;
  font-size: 7px;
  margin-bottom: 2px;
}

/* — Lead cards area — */
.desk-leads {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(4, 130px);
  grid-template-rows: 1fr 1fr;
  gap: var(--sp-1);
  padding: var(--sp-1) var(--sp-3);
  overflow: hidden;
  position: relative;
  align-content: stretch;
  justify-content: center;
}

/* Pencil scratch marks */
.desk-leads::after {
  content: '';
  position: absolute;
  top: 12px;
  left: 10px;
  width: 40px;
  height: 2px;
  background: rgba(60, 40, 20, 0.12);
  transform: rotate(-3deg);
  pointer-events: none;
  z-index: 0;
  box-shadow:
    6px 8px 0 rgba(60, 40, 20, 0.08),
    -2px 14px 0 rgba(60, 40, 20, 0.06);
}

/* — Individual lead card — */
.lead-card {
  background:
    /* Subtle paper fiber texture */
    url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.5' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E"),
    var(--paper-tone, var(--paper));
  border: 1px solid var(--ink-faded);
  padding: 3px var(--sp-2);
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: 2px;
  position: relative;
  z-index: 1;
  transition: border-color 0.15s, transform 0.15s, box-shadow 0.15s;
  overflow: hidden;
  min-height: 0;
  /* Physical paper on desk — heavier shadow, slight wear */
  box-shadow:
    1px 2px 4px rgba(0,0,0,0.25),
    0 0 0 0.5px rgba(0,0,0,0.1);
  /* Deal-in animation */
  opacity: 0;
  animation: card-deal 0.3s cubic-bezier(0.22, 0.61, 0.36, 1) forwards;
}

/* Staggered deal timing — cards dealt one by one */
.lead-card:nth-child(1)  { animation-delay: 0.05s; }
.lead-card:nth-child(2)  { animation-delay: 0.1s; }
.lead-card:nth-child(3)  { animation-delay: 0.15s; }
.lead-card:nth-child(4)  { animation-delay: 0.2s; }
.lead-card:nth-child(5)  { animation-delay: 0.25s; }
.lead-card:nth-child(6)  { animation-delay: 0.3s; }
.lead-card:nth-child(7)  { animation-delay: 0.35s; }
.lead-card:nth-child(8)  { animation-delay: 0.4s; }

@keyframes card-deal {
  0%   { opacity: 0; transform: translateY(-20px) rotate(3deg) scale(0.9); }
  70%  { opacity: 1; transform: translateY(2px) rotate(-0.5deg) scale(1.01); }
  100% { opacity: 1; transform: translateY(0) rotate(var(--card-rot, 0deg)) scale(1); }
}

/* Scattered paper feel — each card slightly askew via custom property */
.lead-card:nth-child(1)  { --card-rot: -0.4deg; }
.lead-card:nth-child(2)  { --card-rot: 0.6deg; }
.lead-card:nth-child(3)  { --card-rot: -0.2deg; }
.lead-card:nth-child(4)  { --card-rot: 0.5deg; }
.lead-card:nth-child(5)  { --card-rot: 0.3deg; }
.lead-card:nth-child(6)  { --card-rot: -0.7deg; }
.lead-card:nth-child(7)  { --card-rot: 0.4deg; }
.lead-card:nth-child(8)  { --card-rot: -0.5deg; }

/* Dog-ear fold mark on some cards */
.lead-card:nth-child(odd)::after {
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  width: 8px;
  height: 8px;
  background: linear-gradient(135deg, transparent 50%, var(--paper-dark) 50%);
  pointer-events: none;
}

.lead-card:hover {
  border-color: var(--ink);
  transform: translateY(-2px) rotate(0deg) !important;
  box-shadow:
    2px 4px 8px rgba(0,0,0,0.35),
    0 0 0 1px rgba(0,0,0,0.08);
}

.lead-card.selected {
  border-color: var(--selected);
  box-shadow:
    0 2px 10px rgba(212, 168, 64, 0.4),
    0 0 0 2px var(--selected);
  z-index: 2;
  transform: translateY(-1px) rotate(0deg) !important;
}

.lead-card.locked {
  opacity: 0.4;
  pointer-events: none;
}

/* Top row: badge + difficulty */
.lead-top-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 4px;
}

/* Source type badge — colored tag */
.lead-badge {
  font-family: var(--font-numbers);
  font-size: 8px;
  text-transform: uppercase;
  letter-spacing: 1px;
  padding: 1px 6px;
  border-radius: 2px;
  color: var(--paper);
  line-height: 1.4;
}

.lead-badge.letter   { background: #8a6a2a; }
.lead-badge.document { background: #4a6a3a; }
.lead-badge.street   { background: #5a3a6a; }

/* Difficulty dots */
.lead-diff {
  display: flex;
  gap: 3px;
  align-items: center;
}

.diff-dot {
  width: 5px;
  height: 5px;
  border-radius: 50%;
  border: 1px solid var(--ink-faded);
  background: transparent;
}

.diff-dot.filled {
  background: var(--ink-faded);
}

/* Lead headline */
.lead-headline {
  font-family: var(--font-headline);
  font-size: 10px;
  color: var(--ink);
  line-height: 1.15;
}

.lead-text {
  font-family: var(--font-body);
  font-size: 7px;
  color: var(--ink-faded);
  line-height: 1.2;
  flex: 1;
  overflow: hidden;
}

.lead-npc {
  font-family: var(--font-body);
  font-size: 6px;
  color: var(--ink-light);
  font-style: italic;
  flex-shrink: 0;
  margin-top: auto;
}

/* — Lead card flair — subtle, randomized per-card via CSS vars — */

/* Coffee stain — large, realistic, half-visible in a corner */
.lead-card.flair-coffee::before {
  content: '';
  position: absolute;
  width: var(--coffee-size, 80px);
  height: var(--coffee-size, 80px);
  border-radius: 50%;
  left: var(--coffee-x, -25px);
  top: var(--coffee-y, -20px);
  /* Realistic coffee stain: dark ring edge + warm brown fill + seepage */
  background:
    /* Outer ring — the dark edge where coffee dried */
    radial-gradient(circle,
      transparent 36%,
      rgba(85, 50, 10, 0.15) 38%,
      rgba(100, 60, 15, 0.28) 42%,
      rgba(85, 50, 10, 0.18) 46%,
      rgba(70, 40, 8, 0.06) 50%,
      transparent 52%
    ),
    /* Secondary ring — slightly offset for organic feel */
    radial-gradient(ellipse at 46% 54%,
      transparent 34%,
      rgba(90, 55, 12, 0.10) 38%,
      rgba(90, 55, 12, 0.14) 43%,
      transparent 48%
    ),
    /* Inner fill — the absorbed coffee, warm tan-brown */
    radial-gradient(circle,
      rgba(140, 100, 45, 0.08) 0%,
      rgba(120, 80, 30, 0.14) 20%,
      rgba(100, 65, 20, 0.10) 35%,
      transparent 46%
    );
  pointer-events: none;
  z-index: 0;
}

/* Faint postal stamp for letters — position via --stamp-x, --stamp-y, --stamp-rot */
.lead-card.flair-stamp::after {
  content: 'MOTTAGET';
  position: absolute;
  top: var(--stamp-y, 45%);
  left: var(--stamp-x, 50%);
  transform: translate(-50%, -50%) rotate(var(--stamp-rot, -18deg));
  font-family: var(--font-numbers);
  font-size: 8px;
  letter-spacing: 2px;
  color: rgba(160, 50, 50, 0.07);
  border: 1px solid rgba(160, 50, 50, 0.06);
  padding: 1px 3px;
  border-radius: 1px;
  pointer-events: none;
  z-index: 0;
  white-space: nowrap;
}
/* Override dog-ear for stamped cards */
.lead-card.flair-stamp:nth-child(odd)::after {
  content: 'MOTTAGET';
  width: auto;
  height: auto;
  background: none;
  top: var(--stamp-y, 45%);
  left: var(--stamp-x, 50%);
  right: auto;
  transform: translate(-50%, -50%) rotate(var(--stamp-rot, -18deg));
}

/* Paper clip — REMOVED (looked unrealistic) */

/* Bottom action bar — heavy desk edge like Papers Please counter */
.desk-action-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--sp-1) var(--sp-8);
  background:
    /* Metal strip */
    linear-gradient(180deg,
      rgba(60,50,30,0.4) 0%,
      rgba(0,0,0,0.2) 2px,
      #1e1508 2px,
      #161004 100%
    );
  border-top: 2px solid rgba(80, 60, 30, 0.4);
  gap: var(--sp-8);
  position: relative;
  z-index: 2;
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
}

.desk-selected-label {
  font-family: var(--font-body);
  font-size: 9px;
  color: var(--paper-dim);
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.desk-investigate-btn {
  background: linear-gradient(180deg, #4a3a24 0%, #2a1f12 100%);
  color: var(--paper);
  border: 2px solid var(--lamp-dim);
  padding: var(--sp-4) var(--sp-16);
  font-family: var(--font-headline);
  font-size: 12px;
  letter-spacing: 1px;
  cursor: pointer;
  /* Heavy physical button — raised off desk */
  box-shadow:
    0 4px 0 #0d0a04,
    0 5px 8px rgba(0,0,0,0.4),
    inset 0 1px 0 rgba(245,228,160,0.1);
  transform: translateY(0);
  transition: transform 60ms ease, box-shadow 60ms ease, background 0.15s, opacity 0.15s;
}

.desk-investigate-btn:hover:not(:disabled) {
  background: linear-gradient(180deg, #5a4a34 0%, #3a2f1a 100%);
  box-shadow:
    0 4px 0 #0d0a04,
    0 6px 10px rgba(0,0,0,0.45),
    inset 0 1px 0 rgba(245,228,160,0.15);
  transform: translateY(-1px);
}

.desk-investigate-btn:active:not(:disabled) {
  /* STAMPED down */
  box-shadow:
    0 1px 0 #0d0a04,
    0 1px 2px rgba(0,0,0,0.4);
  transform: translateY(3px);
  transition: transform 30ms ease, box-shadow 30ms ease;
}

.desk-investigate-btn:disabled {
  opacity: 0.3;
  cursor: default;
  box-shadow: none;
  transform: translateY(2px);
}

/* Legacy (hidden) */
.lead-preview { display: none; }
.lead-difficulty { display: none; }

/* — Day Zero fly-in boss note — */
.flyin-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.55);
  z-index: 50;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
}

.flyin-note {
  background: #ffe680;
  padding: 16px 20px;
  max-width: 280px;
  box-shadow: 2px 3px 8px rgba(0, 0, 0, 0.4);
  border-bottom: 2px solid #d4c060;
  transform: scale(0.3) translateY(60px);
  opacity: 0;
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
              opacity 0.3s ease,
              top 0.5s ease,
              left 0.5s ease,
              max-width 0.5s ease,
              padding 0.5s ease;
}

.flyin-note.visible {
  transform: scale(1) translateY(0);
  opacity: 1;
}

.flyin-note.fly-to-corner {
  position: absolute;
  top: 4px;
  right: 56px;
  left: auto;
  transform: scale(0.55) rotate(2deg);
  opacity: 0;
  max-width: 120px;
  padding: 4px 8px;
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Fade-in for the pinned note after fly animation */
.boss-note.fade-in {
  animation: noteReveal 0.3s ease forwards;
}

@keyframes noteReveal {
  from { opacity: 0; transform: rotate(2deg) scale(0.9); }
  to   { opacity: 1; transform: rotate(2deg) scale(1); }
}

/* ============================================
   INDUSTRISTAD — Town-specific desk overrides
   ============================================ */

/* Desk surface — cooler, greyer wood: steel desk in an industrial office */
#screen-desk.town-industristad {
  background:
    repeating-linear-gradient(
      2deg,
      transparent 0px,
      transparent 3px,
      rgba(0,0,0,0.07) 3px,
      rgba(0,0,0,0.07) 4px
    ),
    radial-gradient(ellipse at 85% 10%, rgba(200,210,220,0.08) 0%, transparent 50%),
    radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.35) 100%),
    linear-gradient(180deg, #2c2c2e 0%, #22222a 30%, #1a1a22 100%);
}

/* Wall behind window — darker, industrial concrete */
.town-industristad .desk-top-bar {
  background:
    linear-gradient(180deg, #141418 0%, #1c1c22 70%, transparent 100%);
}

/* Window frame — steel-grey instead of wood */
.town-industristad .desk-window {
  border-color: #555a60;
  box-shadow: 0 0 20px rgba(180,190,200,0.06);
}

/* Industristad sky — hazier, more polluted */
.town-industristad .desk-window-sky.morning {
  background: linear-gradient(180deg, #7a9ab0 0%, #b0c0cc 60%, #c8c8b4 100%);
}
.town-industristad .desk-window-sky.afternoon {
  background: linear-gradient(180deg, #c09848 0%, #d8b87a 50%, #c0a858 100%);
}
.town-industristad .desk-window-sky.evening {
  background: linear-gradient(180deg, #12101a 0%, #201818 60%, #080810 100%);
}

/* Industrial skyline — factory chimneys, smokestacks, paper mill */
.town-industristad .desk-window-sky::before {
  clip-path: polygon(
    0% 100%,
    /* Low warehouse block */
    0% 78%, 5% 78%, 5% 72%, 10% 72%, 10% 78%,
    /* Smoke stack 1 — tall narrow chimney */
    14% 78%, 14% 28%, 16% 28%, 16% 78%,
    /* Factory building with sawtooth roof */
    18% 78%, 18% 58%, 21% 52%, 24% 58%, 27% 52%, 30% 58%, 30% 78%,
    /* Smoke stack 2 — medium */
    33% 78%, 33% 35%, 35% 35%, 35% 78%,
    /* Main paper mill — large block with tower */
    38% 78%, 38% 50%, 42% 50%, 42% 22%, 44% 22%, 44% 50%,
    48% 50%, 48% 78%,
    /* Gap */
    50% 78%,
    /* Crane structure */
    52% 78%, 52% 42%, 53% 42%, 55% 30%, 57% 42%, 58% 42%, 58% 78%,
    /* Low office block */
    60% 78%, 60% 62%, 68% 62%, 68% 78%,
    /* Smoke stack 3 — tallest */
    70% 78%, 70% 18%, 72% 18%, 72% 78%,
    /* Storage silos — rounded tops */
    74% 78%, 74% 55%, 76% 48%, 78% 55%, 78% 48%, 80% 42%, 82% 48%, 82% 78%,
    /* Small buildings */
    84% 78%, 84% 68%, 90% 68%, 90% 72%,
    /* Final warehouse */
    92% 72%, 92% 65%, 100% 65%,
    100% 100%
  );
  background: #1a1a20;
  opacity: 0.9;
}

/* Industrial window lights — orange/amber industrial glow */
.town-industristad .desk-window-sky::after {
  background:
    /* Furnace glows — larger, orange */
    radial-gradient(circle 2px, rgba(255,140,40,0.6) 0%, transparent 100%) 42px 10px,
    radial-gradient(circle 2px, rgba(255,120,30,0.5) 0%, transparent 100%) 44px 12px,
    /* Window lights */
    radial-gradient(circle 1px, rgba(255,200,80,0.5) 0%, transparent 100%) 20px 6px,
    radial-gradient(circle 1px, rgba(255,200,80,0.4) 0%, transparent 100%) 62px 5px,
    radial-gradient(circle 1px, rgba(255,180,60,0.5) 0%, transparent 100%) 95px 7px,
    radial-gradient(circle 1px, rgba(255,200,80,0.4) 0%, transparent 100%) 130px 4px,
    radial-gradient(circle 1px, rgba(255,160,50,0.6) 0%, transparent 100%) 155px 8px,
    radial-gradient(circle 1px, rgba(255,200,80,0.3) 0%, transparent 100%) 170px 6px;
  background-repeat: no-repeat;
}

/* Smoke wisps from chimneys — CSS animated */
.town-industristad .desk-window-sky .chimney-smoke {
  position: absolute;
  width: 6px;
  height: 12px;
  border-radius: 50%;
  background: rgba(180,180,190,0.25);
  filter: blur(2px);
  animation: smoke-rise 3s ease-out infinite;
  pointer-events: none;
  z-index: 2;
}

.town-industristad .desk-window-sky .chimney-smoke:nth-child(1) {
  left: 14%; bottom: 22px; animation-duration: 2.8s; animation-delay: 0s;
}
.town-industristad .desk-window-sky .chimney-smoke:nth-child(2) {
  left: 15%; bottom: 22px; animation-duration: 3.4s; animation-delay: 1.2s;
  width: 5px; height: 10px;
}
.town-industristad .desk-window-sky .chimney-smoke:nth-child(3) {
  left: 34%; bottom: 16px; animation-duration: 3s; animation-delay: 0.5s;
}
.town-industristad .desk-window-sky .chimney-smoke:nth-child(4) {
  left: 43%; bottom: 28px; animation-duration: 3.6s; animation-delay: 0.8s;
  width: 4px; height: 8px;
}
.town-industristad .desk-window-sky .chimney-smoke:nth-child(5) {
  left: 71%; bottom: 30px; animation-duration: 2.6s; animation-delay: 0.3s;
  width: 7px; height: 14px;
}
.town-industristad .desk-window-sky .chimney-smoke:nth-child(6) {
  left: 72%; bottom: 30px; animation-duration: 3.2s; animation-delay: 1.5s;
  width: 5px; height: 10px;
}

@keyframes smoke-rise {
  0%   { transform: translateY(0) scaleX(1); opacity: 0.35; }
  40%  { transform: translateY(-8px) scaleX(1.3); opacity: 0.25; }
  70%  { transform: translateY(-16px) scaleX(1.8); opacity: 0.12; }
  100% { transform: translateY(-24px) scaleX(2.2); opacity: 0; }
}

/* Industrial desk edge — steel/metal */
#screen-desk.town-industristad::after {
  background: linear-gradient(180deg, transparent, rgba(30,30,40,0.5));
}

/* Action bar — cold metal instead of warm wood */
.town-industristad .desk-action-bar {
  background:
    linear-gradient(180deg,
      rgba(50,50,60,0.4) 0%,
      rgba(0,0,0,0.2) 2px,
      #1a1a22 2px,
      #141418 100%
    );
  border-top: 2px solid rgba(80,80,100,0.3);
}

/* Investigate button — steel blue-grey tone */
.town-industristad .desk-investigate-btn {
  background: linear-gradient(180deg, #3a3a48 0%, #242430 100%);
  border-color: #6a6a78;
  box-shadow:
    0 4px 0 #0a0a10,
    0 5px 8px rgba(0,0,0,0.4),
    inset 0 1px 0 rgba(200,200,220,0.08);
}

.town-industristad .desk-investigate-btn:hover:not(:disabled) {
  background: linear-gradient(180deg, #4a4a58 0%, #2e2e3a 100%);
}

/* Lead cards — slightly cooler, newsprint-grey paper */
.town-industristad .lead-card {
  --paper-tone: #dddce0;
  border-color: #a0a0a8;
}

.town-industristad .lead-card:hover {
  border-color: #606068;
}

.town-industristad .lead-card.selected {
  border-color: #8090a0;
  box-shadow:
    0 2px 10px rgba(100,140,180,0.3),
    0 0 0 2px #8090a0;
}

/* Industrial flair: grease/ink smudge instead of coffee stain */
.town-industristad .lead-card.flair-grease::before {
  content: '';
  position: absolute;
  width: var(--grease-size, 50px);
  height: var(--grease-size, 50px);
  border-radius: 40% 60% 55% 45%;
  left: var(--grease-x, -10px);
  top: var(--grease-y, -8px);
  background:
    radial-gradient(ellipse at 45% 55%,
      rgba(30,30,40,0.12) 0%,
      rgba(40,40,50,0.08) 40%,
      transparent 65%
    );
  pointer-events: none;
  z-index: 0;
  transform: rotate(var(--grease-rot, 15deg));
}

/* Stamp for industristad — HEMLIGT (Classified) */
.town-industristad .lead-card.flair-stamp::after {
  content: 'HEMLIGT';
  color: rgba(180, 50, 50, 0.09);
  border-color: rgba(180, 50, 50, 0.07);
}
.town-industristad .lead-card.flair-stamp:nth-child(odd)::after {
  content: 'HEMLIGT';
}

/* Boss note — cooler tint for Birgit */
.town-industristad .boss-note {
  background: #e8e4d8;
  border-bottom-color: #b0a890;
}

/* Pencil scratch marks — ink-blue for industristad */
.town-industristad .desk-leads::after {
  background: rgba(40, 40, 60, 0.12);
  box-shadow:
    6px 8px 0 rgba(40, 40, 60, 0.08),
    -2px 14px 0 rgba(40, 40, 60, 0.06);
}

/* ── Coal / soot smudge — dark smear from factory fingers ── */
.town-industristad .lead-card.flair-coal::after {
  content: '';
  position: absolute;
  width: 24px;
  height: 14px;
  border-radius: 60% 40% 50% 50%;
  left: var(--coal-x, 50%);
  top: var(--coal-y, 40%);
  background:
    radial-gradient(ellipse at 40% 50%,
      rgba(20, 20, 25, 0.18) 0%,
      rgba(30, 30, 35, 0.10) 50%,
      transparent 75%
    );
  pointer-events: none;
  z-index: 0;
  transform: rotate(var(--coal-rot, 10deg));
  filter: blur(1px);
}

/* Override dog-ear for coal-marked cards */
.town-industristad .lead-card.flair-coal:nth-child(odd)::after {
  content: '';
  width: 24px;
  height: 14px;
  border-radius: 60% 40% 50% 50%;
  left: var(--coal-x, 50%);
  top: var(--coal-y, 40%);
  right: auto;
  background:
    radial-gradient(ellipse at 40% 50%,
      rgba(20, 20, 25, 0.18) 0%,
      rgba(30, 30, 35, 0.10) 50%,
      transparent 75%
    );
  transform: rotate(var(--coal-rot, 10deg));
  filter: blur(1px);
}

/* ── Ripped / torn paper edge — factory wear ── */
.town-industristad .lead-card.flair-ripped {
  overflow: visible;
}

/* Right-side tear */
.town-industristad .lead-card.flair-ripped[data-rip-side="right"] {
  clip-path: polygon(
    0% 0%,
    97% 0%,
    98% 8%,
    96% 15%,
    99% 22%,
    95% 30%,
    98% 38%,
    96% 45%,
    100% 52%,
    95% 60%,
    97% 68%,
    94% 76%,
    98% 84%,
    96% 92%,
    97% 100%,
    0% 100%
  );
}

/* Bottom-edge tear */
.town-industristad .lead-card.flair-ripped[data-rip-side="bottom"] {
  clip-path: polygon(
    0% 0%,
    100% 0%,
    100% 94%,
    92% 96%,
    85% 93%,
    78% 97%,
    70% 94%,
    62% 98%,
    55% 95%,
    48% 97%,
    40% 93%,
    32% 96%,
    25% 94%,
    18% 98%,
    10% 95%,
    4% 97%,
    0% 94%
  );
}

/* Torn edge shadow hint */
.town-industristad .lead-card.flair-ripped::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.town-industristad .lead-card.flair-ripped[data-rip-side="right"]::before {
  box-shadow: inset -2px 0 3px rgba(0,0,0,0.08);
}

.town-industristad .lead-card.flair-ripped[data-rip-side="bottom"]::before {
  box-shadow: inset 0 -2px 3px rgba(0,0,0,0.08);
}

/* ============================================
   KUSTSTAD — Coastal harbor town overrides
   ============================================ */

/* Window frame — weathered wood, salt-stained */
.town-kuststad .desk-window {
  border-color: #6a7a70;
  box-shadow: 0 0 20px rgba(120,160,180,0.08);
}

/* Kuststad sky — cold North Sea, foggy */
.town-kuststad .desk-window-sky.morning {
  background: linear-gradient(180deg, #7a96a8 0%, #a0b8c8 50%, #c4c8c0 100%);
}
.town-kuststad .desk-window-sky.afternoon {
  background: linear-gradient(180deg, #b8a070 0%, #c8b088 40%, #a0a898 100%);
}
.town-kuststad .desk-window-sky.evening {
  background: linear-gradient(180deg, #101820 0%, #182028 50%, #0a1018 100%);
}

/* Harbor skyline — cranes, masts, lighthouse, fishing sheds */
.town-kuststad .desk-window-sky::before {
  clip-path: polygon(
    0% 100%,
    /* Rocky shore shelf */
    0% 85%, 3% 84%, 5% 86%,
    /* Fish shed 1 — low pitched roof */
    7% 86%, 7% 72%, 9% 68%, 11% 72%, 11% 86%,
    /* Pier posts */
    13% 86%, 13% 82%, 14% 82%, 14% 86%,
    /* Fishing boat mast 1 */
    16% 86%, 16% 40%, 17% 40%, 17% 86%,
    /* Boat hull */
    18% 86%, 18% 78%, 22% 78%, 22% 86%,
    /* Fishing boat mast 2 */
    24% 86%, 24% 35%, 25% 35%, 25% 86%,
    /* Harbor master's office — boxy with flag */
    28% 86%, 28% 62%, 30% 62%, 30% 55%, 31% 55%, 31% 62%,
    34% 62%, 34% 86%,
    /* Gap — open water */
    36% 86%,
    /* Large crane — harbor crane */
    38% 86%, 38% 30%, 39% 28%, 40% 30%,
    43% 40%, 42% 40%, 42% 86%,
    /* Crane arm horizontal */
    /* Warehouse — long low building */
    44% 86%, 44% 68%, 54% 68%, 54% 86%,
    /* Cargo ship silhouette */
    56% 86%, 56% 72%, 58% 68%, 62% 65%, 66% 65%,
    68% 68%, 70% 72%, 70% 86%,
    /* Lighthouse — tall narrow tower */
    72% 86%, 73% 86%, 73% 20%, 74% 18%, 75% 20%,
    75% 86%,
    /* Rock formation */
    77% 86%, 78% 80%, 80% 82%, 82% 78%,
    /* Small fishing huts */
    84% 78%, 84% 70%, 86% 66%, 88% 70%, 88% 78%,
    90% 78%, 90% 72%, 92% 68%, 94% 72%, 94% 78%,
    /* Shore slope */
    96% 80%, 100% 82%,
    100% 100%
  );
  background: #1a2028;
  opacity: 0.85;
}

/* Harbor lights — navigation lamps, ship portholes, lighthouse beam */
.town-kuststad .desk-window-sky::after {
  background:
    /* Lighthouse lamp — brighter, warm */
    radial-gradient(circle 3px, rgba(255,220,100,0.7) 0%, transparent 100%) 120px 5px,
    /* Ship portholes — dim yellow */
    radial-gradient(circle 1px, rgba(255,200,80,0.4) 0%, transparent 100%) 96px 7px,
    radial-gradient(circle 1px, rgba(255,200,80,0.3) 0%, transparent 100%) 100px 7px,
    radial-gradient(circle 1px, rgba(255,200,80,0.35) 0%, transparent 100%) 104px 7px,
    /* Harbor office windows */
    radial-gradient(circle 1px, rgba(255,180,60,0.5) 0%, transparent 100%) 48px 5px,
    radial-gradient(circle 1px, rgba(255,180,60,0.4) 0%, transparent 100%) 50px 5px,
    /* Crane warning light — red */
    radial-gradient(circle 1.5px, rgba(255,60,40,0.5) 0%, transparent 100%) 65px 3px,
    /* Pier lamps — faint */
    radial-gradient(circle 1px, rgba(255,200,80,0.25) 0%, transparent 100%) 22px 9px,
    radial-gradient(circle 1px, rgba(255,200,80,0.2) 0%, transparent 100%) 145px 6px;
  background-repeat: no-repeat;
}

/* Harbor waves — subtle animated water movement */
.town-kuststad .desk-window-sky .harbor-wave {
  position: absolute;
  width: 100%;
  height: 3px;
  bottom: 0;
  left: 0;
  background: linear-gradient(90deg,
    transparent 0%,
    rgba(120,160,200,0.08) 20%,
    rgba(120,160,200,0.12) 40%,
    rgba(120,160,200,0.06) 60%,
    transparent 80%
  );
  animation: harbor-wave 4s ease-in-out infinite;
  pointer-events: none;
  z-index: 2;
}

.town-kuststad .desk-window-sky .harbor-wave:nth-child(1) {
  bottom: 1px; animation-duration: 3.8s; animation-delay: 0s;
}
.town-kuststad .desk-window-sky .harbor-wave:nth-child(2) {
  bottom: 3px; animation-duration: 4.2s; animation-delay: 0.8s;
  opacity: 0.7;
}
.town-kuststad .desk-window-sky .harbor-wave:nth-child(3) {
  bottom: 5px; animation-duration: 3.5s; animation-delay: 1.5s;
  opacity: 0.5;
}
.town-kuststad .desk-window-sky .harbor-wave:nth-child(4) {
  bottom: 7px; animation-duration: 4.6s; animation-delay: 0.4s;
  opacity: 0.3;
}

@keyframes harbor-wave {
  0%   { transform: translateX(-5px); opacity: 0.6; }
  50%  { transform: translateX(5px); opacity: 1; }
  100% { transform: translateX(-5px); opacity: 0.6; }
}

/* Coastal desk edge — weathered wood, lighter than default */
#screen-desk.town-kuststad::after {
  background: linear-gradient(180deg, transparent, rgba(20,30,40,0.4));
}

/* Action bar — salt-weathered wood */
.town-kuststad .desk-action-bar {
  background:
    linear-gradient(180deg,
      rgba(60,70,65,0.4) 0%,
      rgba(0,0,0,0.15) 2px,
      #1c2420 2px,
      #141c18 100%
    );
  border-top: 2px solid rgba(80,100,90,0.3);
}

/* Investigate button — dark teal/maritime */
.town-kuststad .desk-investigate-btn {
  background: linear-gradient(180deg, #2a3a38 0%, #1a2a28 100%);
  border-color: #5a7a70;
  box-shadow:
    0 4px 0 #0a1210,
    0 5px 8px rgba(0,0,0,0.4),
    inset 0 1px 0 rgba(180,220,200,0.08);
}

.town-kuststad .desk-investigate-btn:hover:not(:disabled) {
  background: linear-gradient(180deg, #3a4a48 0%, #2a3a38 100%);
}

/* Lead cards — weathered, sea-mist paper */
.town-kuststad .lead-card {
  --paper-tone: #e0ddd8;
  border-color: #a0a898;
}

.town-kuststad .lead-card:hover {
  border-color: #607068;
}

.town-kuststad .lead-card.selected {
  border-color: #6a8a80;
  box-shadow:
    0 2px 10px rgba(80,140,130,0.3),
    0 0 0 2px #6a8a80;
}

/* Boss note — salt-weathered, slightly blue */
.town-kuststad .boss-note {
  background: #e4e0d8;
  border-bottom-color: #a0a898;
}

/* ── Salt damage flair — white mineral crust ── */
.town-kuststad .lead-card.flair-salt::after {
  content: '';
  position: absolute;
  width: 30px;
  height: 18px;
  border-radius: 50% 60% 40% 50%;
  left: var(--salt-x, 50%);
  top: var(--salt-y, 40%);
  background:
    radial-gradient(ellipse at 40% 50%,
      rgba(255, 255, 255, 0.15) 0%,
      rgba(240, 240, 235, 0.08) 50%,
      transparent 75%
    );
  pointer-events: none;
  z-index: 0;
  transform: rotate(var(--salt-rot, 5deg));
  filter: blur(0.5px);
}

/* ── Water ring — wet glass mark ── */
.town-kuststad .lead-card.flair-waterring::before {
  content: '';
  position: absolute;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  left: var(--water-x, 60%);
  top: var(--water-y, 50%);
  border: 2px solid rgba(140, 170, 190, 0.10);
  background: transparent;
  pointer-events: none;
  z-index: 0;
}

/* ── Rope mark — diagonal crease line ── */
.town-kuststad .lead-card.flair-rope::after {
  content: '';
  position: absolute;
  width: 120%;
  height: 2px;
  left: -10%;
  top: 45%;
  background: linear-gradient(90deg,
    transparent 0%,
    rgba(100, 80, 60, 0.06) 20%,
    rgba(100, 80, 60, 0.10) 50%,
    rgba(100, 80, 60, 0.06) 80%,
    transparent 100%
  );
  transform: rotate(var(--rope-angle, -5deg));
  pointer-events: none;
  z-index: 0;
}

/* Stamp for kuststad — KONFIDENTIELLT (Confidential) */
.town-kuststad .lead-card.flair-stamp::after {
  content: 'LOGGBOK';
  color: rgba(40, 80, 120, 0.09);
  border-color: rgba(40, 80, 120, 0.07);
}
.town-kuststad .lead-card.flair-stamp:nth-child(odd)::after {
  content: 'LOGGBOK';
}

/* Pencil scratch marks — blue-green for kuststad */
.town-kuststad .desk-leads::after {
  background: rgba(40, 60, 50, 0.12);
  box-shadow:
    6px 8px 0 rgba(40, 60, 50, 0.08),
    -2px 14px 0 rgba(40, 60, 50, 0.06);
}
